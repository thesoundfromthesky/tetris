import{I as u,u as l,r as h}from"./index-CfS70t6F.js";import{G as m}from"./glTFLoader-DQB8554u.js";import"./objectModelMapping-D4YYZYlG.js";const o="KHR_materials_clearcoat";class d{constructor(s){this.name=o,this.order=190,this._loader=s,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(s,r,e){return m.LoadExtensionAsync(s,r,this.name,(t,a)=>{const c=new Array;return c.push(this._loader.loadMaterialPropertiesAsync(s,r,e)),c.push(this._loadClearCoatPropertiesAsync(t,a,e)),Promise.all(c).then(()=>{})})}_loadClearCoatPropertiesAsync(s,r,e){if(!(e instanceof u))throw new Error(`${s}: Material type not supported`);const t=new Array;return e.clearCoat.isEnabled=!0,e.clearCoat.useRoughnessFromMainTexture=!1,e.clearCoat.remapF0OnInterfaceChange=!1,r.clearcoatFactor!=null?e.clearCoat.intensity=r.clearcoatFactor:e.clearCoat.intensity=0,r.clearcoatTexture&&t.push(this._loader.loadTextureInfoAsync(`${s}/clearcoatTexture`,r.clearcoatTexture,a=>{a.name=`${e.name} (ClearCoat)`,e.clearCoat.texture=a})),r.clearcoatRoughnessFactor!=null?e.clearCoat.roughness=r.clearcoatRoughnessFactor:e.clearCoat.roughness=0,r.clearcoatRoughnessTexture&&(r.clearcoatRoughnessTexture.nonColorData=!0,t.push(this._loader.loadTextureInfoAsync(`${s}/clearcoatRoughnessTexture`,r.clearcoatRoughnessTexture,a=>{a.name=`${e.name} (ClearCoat Roughness)`,e.clearCoat.textureRoughness=a}))),r.clearcoatNormalTexture&&(r.clearcoatNormalTexture.nonColorData=!0,t.push(this._loader.loadTextureInfoAsync(`${s}/clearcoatNormalTexture`,r.clearcoatNormalTexture,a=>{a.name=`${e.name} (ClearCoat Normal)`,e.clearCoat.bumpTexture=a})),e.invertNormalMapX=!e.getScene().useRightHandedSystem,e.invertNormalMapY=e.getScene().useRightHandedSystem,r.clearcoatNormalTexture.scale!=null&&(e.clearCoat.bumpTexture.level=r.clearcoatNormalTexture.scale)),Promise.all(t).then(()=>{})}}l(o);h(o,!0,n=>new d(n));export{d as KHR_materials_clearcoat};
